## Windows Security
### Table of Contents
* [Security Access Tokens (SATs)](#security-access-tokens-sats)
* [Privileges](#privileges)
* [Integrity Levels](#integrity-levels)
* [User Account Control (UAC)](#user-account-control-uac)
* [File Permissions](#file-permissions)
* [Logon Rights](#logon-rights)
* [References](#references)

### Security Access Tokens (SATs)
A user's SAT is attached to every process they launch. It represents what they are authorized to do and is generated by the Local Security Authority Subsystem Service (LSASS). A SAT includes the following elements:
* User's SID
* SIDs of user's global/local group memberships
* SID of user's integrity level
* Privileges on the local system
* Active Directory attributes

### Privileges 
Privileges represent what users are specifically allowed to do to other processes. The following are considered maleficent privileges: 
* Act as a Part of the Operating System: create a new logon session via username/password or group memberships. 
* Create a Token Object: execute a command under the context of a new SAT. 
* Debug Programs: inject a malicious DLL into a process or dump password hashes.
* Impersonate a Client: steal someone’s SAT after they authenticate. 
* Load and Unload Device Drivers: load drivers and execute malicious commands.  
* Restore Files and Directories: bypass NTFS permissions and replace any file (i.e. OS or application binaries).
* Take Ownership: change permissions (the ACL) for processes, threads, registry keys, etc.

### Integrity Levels
Mandatory Integrity Control (MIC) allows the Windows kernel to “...enforce new access control restrictions that cannot be defined by granting user or group permissions in access control lists (ACLs).” MIC represents Microsoft’s implementation of the Biba Mandatory Access Control (MAC) model and is enforced prior to file permissions. MIC labels, also known as mandatory labels, integrity labels, or integrity levels, prevent processes of lower integrity from reading, writing, and/or executing objects of higher integrity. MIC labels are also partly determined by the type of privileges allocated to a user. A user’s integrity level will be one of the following: 
* System: SYSTEM
* High: administrator
* Medium: standard
* Low: very restricted

### User Account Control (UAC)
UAC prevents processes from silently doing things that will have a system-wide impact. UAC does this by separating a user’s privileges into two different SATs and requiring the  express authorization of an administrator before elevating to the SAT with a higher integrity level. Elevating one’s privileges via UAC happens in either credential or consent mode. In credential mode, a user will be prompted for administrator credentials. Most users will experience this mode. In consent mode, a user will be prompted for consent. Administrators will be asked for consent instead of their credentials as they have already proven their identity at login. The example below demonstrates how to elevate from a medium integrity level to a high integrity level. 

```bash
net user administrator password123
# Access is denied. 

powershell Start-Process cmd.exe -Verb RunAs
net user administrator password123
# The command completed successfully.
```

### File Permissions
Text goes here.

### Logon Rights
Text goes here.

### References
* https://isc.sans.edu/forums/diary/Limiting+Exploit+Capabilities+by+Using+Windows+Integrity+Levels/10531/
