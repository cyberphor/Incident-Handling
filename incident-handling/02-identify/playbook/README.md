# Incident Handling Playbook Design

## Contents
* [Triggers](#triggers)
* [Naming Convention](#naming-convention)
  * [Unique Identifier](#unique-identifier)
  * [Confidence Level](#confidence-level)
  * [Data Source Identifier](#data-source-identifer)
  * [Incident Category](#incident-category)
  * [Description](#description)
* [Objective](#objective)
  *[Example Objective](#example-objective)
* [Analysis](#analysis)
* [Query](#query)
* [Notes](#notes)

## Triggers
Below is a list of triggers for the defender to invoke a incident detection/response play.
* NIDS alert
* AV alert
* Server crash (DOS)
* Users complain of slow network access
* System administrator noticies unusual filename
* User reports a suspicious email message
* Computer records a suspicious configuration change
* Computer records multiple failed logins from a remote IP address
* Email administrator notices deviations from the expected baseline for network traffic
* Network administrator notices unauthorized, outbound network connections

## Naming Convention
```
<uid>-<cl>-<dsid>-<cat>: <desc>
```

### Examples
* 200-sus-nid-cat6: Detect a network scan
  * Requires the analyst to confirm there was an unauthorized network scan.
* 201-mal-nid-cat6: Respond to an unauthorized network scan
  * Requires the analyst to remediate there was an unauthorized network scan.
* 500-mal-sys-cat5: Detect a USB violation
  * Requires the analyst to remediate a policy violation.
* 501-mal-sys-cat5: Respond to a USB violation
  * Requires the analyst to remediate a policy violation.

### Unique Identifer
| Unique Identifier (UID) Range | Data Source (DS) | DS Identifier (DSID) |
| ----------------------------- | ---------------- | -------------------- |
| 000 - 099 | Reserved | RES |
| 100 - 199 | Network Perimeter Logs | NFW | 
| 200 - 299 | NIDS Alerts | NID |
| 300 - 399 | Host Perimeter Logs | HFW |
| 400 - 499 | HIDS Alerts | HID |
| 500 - 599 | System Logs | SYS |
| 600 - 699 | Application Logs | APP |
| 700 - 799 | Service Logs | SRV |
| 800 - 899 | Human | HUM |
| 900 - 999 | Multiple | MUL |

### Confidence Level
#### Suspicious (SUS)
n/a

#### Malicious (MAL)
n/a

### Incident Category
| Category (CAT) | Incident |
| -------------- | -------- |
| CAT1 | Root-Level Intrusion |
| CAT2 | User-Level Intrusion | 
| CAT3 | Unsuccesful Activity Attempt |
| CAT4 | Denial of Service |
| CAT5 | Non-Compliance Activity | 
| CAT6 | Reconnaissance |
| CAT7 | Malicious Logic |

### Description
The Description element summarizes what the play is seeking to address.

# Objective
The Objective of a play represents the best way to find and present information, given a scneario. It is an endstate and should be written in a way that makes its purpose obvious. It should also achieve one of the following:
* Explains how a machine was infected (by virus, worm, trojan, etc.)
* Explains suspicious network activity
* Helps the defender detect suspicious logon attempts
* Summarizes information such as trends, and/or statistics
* Provides a tailored view of a specifc topic (vulnerability, exploit, technique, etc.)

## Objective Example
> The first phase an attack cycle is reconnaissance. During this phase, attackers use network scans to learn about the scale and characteristics of their target environment. The host/network perimeter logs and Network Intrusion Detection Systems (NIDS) alerts generated by our security infrastructure allow us to detect this activity. This play looks for indicators of someone attempting to gather information about the network and/or the computers, applications, and users it supports in preparation of an attack.

# Analysis

# Query

# Notes
