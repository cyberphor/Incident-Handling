# 200-SUS-NID-CAT6
Detect a network scan

# Objective
The first phase an attack cycle is reconnaissance. During this phase, attackers use network scans to learn about the scale and characteristics of their target environment. The host/network perimeter logs and Network Intrusion Detection Systems (NIDS) alerts generated by our security infrastructure allow us to detect this activity. This play looks for indicators of someone attempting to gather information about the network and/or the computers, applications, and users it supports in preparation of an attack.

# Analysis
Scans generates can logs with multiple "one-to-many" network connections in a short amount of time. Yet, attackers have also been observed using "low and slow" techniques to avoid detection. This play looks for IP addresses sending network traffic to multiple computers. The following IP addresses belong to our organization's vulnerability scanners and are known for generating false positives.
* Logs with the source IP address of a computer outside the 10.11.12.0/24 network are true positives.
* Reference our Asset Inventory to identify the hostname, user, and department for computers relevant to the investigation.
* We have observed TCP port 0 in Windows Event logs where ICMP was used.
* Search online for any port you cannot identi

# Query
1. Login to Kibana
2. Navigate to the Discover tab
3. Add the following fields to the default Visualization: source.ip, source.port, destination.ip, destination.port
5. Add the following filter to the default Visualization: Field = source.ip, Operator = exists
6. Input the query below into the search bar and then, click-on the Refresh button on the top-right of the screen
```bash
# check for ICMP traffic
destination.port:0
```

# Notes
* n/a
